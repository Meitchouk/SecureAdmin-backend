# Secure Admin Backend

This is the backend of the **Secure Admin** project, a RESTful API developed with [NestJS](https://nestjs.com/) and [Prisma](https://www.prisma.io/) as the ORM. The API manages users and roles, implements JWT authentication, and protects endpoints with Guards to control access based on roles.

## Features

- **CRUD of Users and Roles**: Implements create, read, update, and delete operations for users and roles.
- **JWT Authentication**: Protects endpoints using JWT tokens.
- **Role-Based Access Control**: Implements Guards to verify user roles and control access to specific endpoints.
- **Password Recovery**: Allows users to recover their passwords using a token sent via email.
- **Database Seed**: Initializes the database with a Super Admin user.

## Requirements

- Node.js v14 or higher
- npm v6 or higher
- PostgreSQL (can be replaced with MySQL, SQL Server, or MongoDB)
- Prisma CLI

## Project Setup

1. **Clone the Repository**

  ```bash
  git clone https://github.com/Meitchouk/SecureAdmin-frontend.git
  cd secure-admin-backend
  ```

2. Install Dependencies

  Run the following command to install all the necessary dependencies:

  ```bash
  npm install
  ```

3. Configure Environment Variables

  Create a `.env` file in the root of the project with the following content:

  ```env
  DATABASE_URL="postgresql://username:password@localhost:5432/your_database"
  JWT_SECRET="your_jwt_secret"
  JWT_EXPIRES_IN="60m"
  ```

  Make sure to replace the values with your own credentials and configurations.

4. Configure Prisma

  If you haven't done so already, initialize Prisma:

  ```bash
  npx prisma init
  ```

  Then, run the migrations to create the tables in your database:

  ```bash
  npx prisma migrate dev --name init
  ```

  Finally, run the seed to populate the database with initial data:

  ```bash
  npx prisma db seed
  ```

5. Run the Server

  To start the server in development mode, use the following command:

  ```bash
  npm run start:dev
  ```

  The server will be available at http://localhost:3000.

API Documentation
The API documentation generated by Swagger is available at:

```bash
http://localhost:3000/api/docs
```

Project Structure
The current structure of the project is as follows:

```bash
src/
│
├── auth/                 # Authentication module (JWT, Guards, etc.)
│   ├── auth.controller.ts
│   ├── auth.service.ts
│   ├── jwt-auth.guard.ts
│   ├── jwt.strategy.ts
│   ├── roles.guard.ts
│   ├── self-role.guard.ts
│   └── auth.module.ts
│
├── prisma/               # Prisma service and configuration
│   ├── prisma.module.ts
│   ├── prisma.service.ts
│   └── prisma.service.spec.ts
│
├── roles/                # Roles CRUD
│   ├── dto/
│   ├── roles.controller.ts
│   ├── roles.service.ts
│   ├── roles.module.ts
│   └── roles.service.spec.ts
│
├── users/                # Users CRUD
│   ├── dto/
│   ├── users.controller.ts
│   ├── users.service.ts
│   ├── users.module.ts
│   └── users.service.spec.ts
│
├── types/                # Additional types and definitions
│   └── express.d.ts
│
├── app.controller.ts     # Main controller
├── app.service.ts        # Main service
├── app.module.ts         # Root module of the application
└── main.ts               # Entry point of the application
```

Testing
The tests are still under development. The current test files are located in the following locations:

- auth/auth.service.spec.ts
- prisma/prisma.service.spec.ts
- roles/roles.service.spec.ts
- users/users.service.spec.ts

To run the tests, use the following command:

```bash
npm run test
```

Deployment
Deployment is still pending. Instructions will be added to this README once deployment is set up.

Contribution
Contributions are welcome. To contribute:

1. Fork the project.
2. Create a new branch (`git checkout -b feature/new-feature`).
3. Make your changes and commit (`git commit -m 'Add new feature'`).
4. Push to the branch (`git push origin feature/new-feature`).
5. Open a Pull Request.

License
This project does not have a defined license yet.

